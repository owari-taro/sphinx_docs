=====================
2024/07
=====================

-------------------
7/24
-------------------
django ninja
=========================
openapiのversion変更方法
--------------------------------
* openversionはコードを直接書きかえればいい。(`issue <https://github.com/vitalik/django-ninja/pull/923>`__　の変更ファイルを確認するとわかる。fastapiのように公開インターフェースから書き換える方法はなく直接コードを書き換える必要がある)  
* defaultでopenapi versionが3.1.0になっている。



::
    
      #ninja/openapi/schema.py
      extra_info = api.openapi_extra.get("info", {})
        super().__init__(
            [
                #("openapi", "3.0.2"),
                ("openapi", "3.1.0"),
                (
                    "info",
                    {
uploadfileを保存する
--------------------------------
*  FileSystemStorageを使う
* `stack-overflow <https://stackoverflow.com/questions/26274021/simply-save-file-to-folder-in-django>`__

::
    
    from django.shortcuts import render
    from django.conf import settings
    from django.core.files.storage import FileSystemStorage
    
    def upload(request):
        folder='my_folder/' 
        if request.method == 'POST' and request.FILES['myfile']:
            myfile = request.FILES['myfile']
            fs = FileSystemStorage(location=folder) #defaults to   MEDIA_ROOT  
            filename = fs.save(myfile.name, myfile)
            file_url = fs.url(filename)
            return render(request, 'upload.html', {
                'file_url': file_url
            })
        else:
             return render(request, 'upload.html')

